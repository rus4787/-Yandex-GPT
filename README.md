# Проект: Анализ взаимодействий с клиентами с использованием Yandex GPT

## Описание
Проект предназначен для автоматизации анализа взаимодействий менеджеров с клиентами с использованием Yandex GPT. Он включает в себя набор агентов, каждый из которых выполняет специализированные задачи для обработки транскриптов разговоров, выделения ключевых моментов и формирования структурированного отчета. Проект состоит из нескольких модулей, которые взаимодействуют друг с другом для достижения общей цели — получения детализированного анализа по каждому взаимодействию.

## Структура проекта

### Главная папка проекта
`C:\Users\khabi\VS_Project\project-folder\yandex`

### Основная структура
- **index.py**: Получение токена через API Yandex GPT.
- **test.py**: Обработка токена и сохранение в token_cache.json.
- **token_cache.json**: Файл с сохраненным токеном для использования API.

### Листы для агентов
- **processor.py**: "Обработчик" — первичная обработка текста, приведение к нужному формату, выделение ролей в диалоге.
- **label.py**: "Лейбл" — присваивание соответствующих лейблов тексту, таких как тип клиента и результат взаимодействия.
- **distributor.py**: "Распределитель" — основной координирующий агент для распределения задач агентам "Оценщик", "Контроль" и "Накопитель".
- **evaluator.py**: "Оценщик" — блок агентов, которые выполняют специализированные задачи по анализу текста (выделение модуля вовлеченности, причин отказа, успешных действий и т.д.).
- **control.py**: "Контроль" — проверяет результаты анализа агентов "Оценщик", оценивает их полноту и соответствие заданию.
- **accumulator.py**: "Накопитель" — накапливает и обрабатывает данные, передает их агенту "Ревизор".
- **reviewer.py**: "Ревизор" — проводит итоговую проверку ответов агентов "Оценщик", устраняет противоречия и обеспечивает логическую связность.
- **stylist.py**: "Стилист" — готовит итоговый отчет пользователю в профессиональном и понятном формате.
- **buffer**: "Буфер" - оценивает ответы менеджера на предмет их улучшения

### Дополнительные модули
- **preprocessing_text.py**: Подготовка данных, загрузка и фильтрация таблицы, передача текста на обработку.
- **user.py**: Имитация взаимодействия с пользователем. Загружает данные, обрабатывает строки с помощью агентов и сохраняет результаты.
- **prompts.py**: Шаблоны промтов для агентов, включающие роли, задачи, температуру и другие параметры, необходимые для обработки.

### Тестовые данные
Используется файл `data_call_extended.xlsx` для тестирования обработки данных. В модуле `preprocessing_text.py` последние 10 строк этого файла используются для наладки и проверки работы агентов.

## Как запустить проект

1. **Установка зависимостей**
   Убедитесь, что у вас установлены все необходимые библиотеки, такие как `pandas`, `requests` и другие, которые могут понадобиться для взаимодействия с API Yandex GPT и работы с данными. Используйте `pip` для установки зависимостей:
   ```sh
   pip install -r requirements.txt
   ```

2. **Получение токена Yandex GPT**
   В файле `index.py` необходимо выполнить запрос к API Yandex для получения IAM токена. Токен сохраняется в `token_cache.json` и используется для всех последующих запросов.

3. **Запуск предварительной обработки данных**
   В файле `preprocessing_text.py` выполняется загрузка и фильтрация данных из Excel-файла. Последние 10 строк выбираются для тестирования.
   ```sh
   python preprocessing_text.py
   ```

4. **Запуск основного анализа данных**
   Основной анализ данных выполняется через `user.py`, который использует агентов для обработки текстов и формирования итогового отчета.
   ```sh
   python user.py
   ```

## Описание работы агентов

Проект основан на модульном подходе, где каждый агент выполняет свою специализированную задачу:
- **"Обработчик"**: Выполняет первичную обработку текста.
- **"Лейбл"**: Оценивает текст и присваивает лейблы.
- **"Распределитель"**: Координирует дальнейшую обработку текста агентами "Оценщик", "Контроль", "Накопитель".
- **"Оценщик"**: Выделяет важные моменты разговора, такие как модули вовлеченности и результаты взаимодействия.
- **"Контроль"**: Проверяет полноту и корректность работы агентов "Оценщик".
- **"Накопитель"**: Сохраняет и обрабатывает промежуточные результаты.
- **"Ревизор"**: Выполняет итоговую проверку и устраняет логические несоответствия.
- **"Стилист"**: Формирует итоговый отчет в структурированном формате JSON.

## Формат вывода
Итоговый отчет формируется в формате JSON, который включает:
- **summary**: Краткое резюме результатов анализа.
- **details**: Подробная информация по взаимодействию с разделением на типы клиентов, результаты анализа и другие блоки.
- **comments**: Комментарии от агентов "Ревизор" и "Контроль".
- **quotes**: Цитаты из исходного текста, сохраненные в неизменном виде.

## Лицензия
Проект распространяется под лицензией MIT. Вы можете свободно использовать и изменять код в соответствии с условиями данной лицензии.

## Контакты
Для вопросов и предложений по проекту, пожалуйста, свяжитесь с нами по электронной почте: `example@example.com`.

